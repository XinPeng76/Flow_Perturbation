# Flow_Perturbation
We introduce the flow perturbation method, which incorporates optimized stochastic perturbations into the flow. By reweighting trajectories generated by the perturbed flow, our method achieves
unbiased sampling of the Boltzmann distribution with orders of magnitude speedup compared to both brute force
Jacobian calculations and the Hutchinson estimator. 

![Flow Perturbation](./data/ODE_pf.pdf "Title")

Publication
-----------
Please find the arxiv preprint here:
[https://arxiv.org/abs/2002.06707](https://arxiv.org/abs/2407.10666)

Citation update is coming up...
```
@article{peng2024flow,
  title={Flow Perturbation to Accelerate Unbiased Sampling of Boltzmann distribution},
  author={Peng, Xin and Gao, Ang},
  journal={arXiv preprint arXiv:2407.10666},
  year={2024}
}
```
***
## [Dependencies](#dependencies)
* Mandatory
  * [pytorch>=2.0](https://github.com/pytorch/pytorch)
  * [numpy](https://github.com/numpy/numpy)
  * [bgmol](https://github.com/noegroup/bgmol) (for  Chignolin)
  * [bgflow](https://github.com/noegroup/bgflow) (for  Chignolin)
  * [mdtraj](https://github.com/mdtraj/mdtraj)(for  Chignolin)
